<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Minecraft‚ÄëStyle Map Viewer</title>
  <style>
    body { font-family: sans-serif; background:#f0f0f0; padding:20px; }
    canvas { border:1px solid #333; cursor:grab; display:block; margin-top:10px; }
    #controls { background:#fff; padding:10px; border:1px solid #ccc; border-radius:6px; max-width:320px; }
    label { display:block; margin:6px 0; }
    #tooltip { position:absolute; background:#fff; border:1px solid #333; padding:5px; display:none; pointer-events:none; font-size:13px; }
  </style>
</head>
<body>
  <h2>üó∫Ô∏è Minecraft‚ÄëStyle Map Viewer</h2>
  <div id="controls">
    <label>Seed: <input type="number" id="seed" value="12345"></label>
    <label>Your X (block): <input type="number" id="playerX" value="0"></label>
    <label>Your Z (block): <input type="number" id="playerZ" value="0"></label>
    <label>Map size (blocks, radius): <input type="number" id="range" value="128"></label>
    <label><input type="checkbox" id="showTerrain" checked> Terrain</label>
    <label><input type="checkbox" id="heightShading" checked> Height shading</label>
    <label><input type="checkbox" id="showSlime" checked> Slime chunks</label>
    <label><input type="checkbox" id="showStructures" checked> Structures</label>
    <label><input type="checkbox" id="showCaves"> Cave preview</label>
    <label><input type="checkbox" id="showGrid"> Show grid</label>
    <button onclick="drawMap()">Generate</button>
    <button onclick="exportMap()">Export PNG</button>
  </div>

  <canvas id="map" width="800" height="800"></canvas>
  <div id="tooltip"></div>

<script src="https://cdn.jsdelivr.net/npm/open-simplex-noise@2.5.0/lib/esm/index.js"></script>
<script>
const canvas = document.getElementById('map');
const ctx = canvas.getContext('2d');
const tooltip = document.getElementById('tooltip');
let zoom=1, offsetX=0, offsetZ=0, dragging=false, dragStartX=0, dragStartY=0;
let noiseGen;

// Minecraft‚Äëlike biome colors
const COLORS = {
  ocean: [64,64,255],
  beach: [250,240,190],
  plains: [141,179,96],
  forest: [34,85,28],
  desert: [210,180,64],
  mountain: [128,128,128],
  snow: [240,240,240]
};

function biomeColor(x,z){
  const h = noiseGen.noise2D(x/200,z/200); // height
  const m = noiseGen.noise2D((x+1000)/200,(z-1000)/200); // moisture
  if(h<-0.2) return COLORS.ocean;
  if(h<-0.1) return COLORS.beach;
  if(h>0.6) return COLORS.snow;
  if(h>0.4) return COLORS.mountain;
  if(m>0.2) return COLORS.forest;
  if(m<-0.2) return COLORS.desert;
  return COLORS.plains;
}

function shadeColor(rgb,elev,enabled){
  if(!enabled) return rgb;
  const factor=(elev+1)/2*0.3; // subtle shading
  return rgb.map(c=>Math.min(255,Math.max(0,c+factor*50)));
}

function isSlimeChunk(seed,x,z){
  const cx=Math.floor(x/16), cz=Math.floor(z/16);
  let rnd = BigInt(seed) +
            BigInt(cx)*BigInt(cx)*0x4c1906n +
            BigInt(cx)*0x5ac0dbn +
            BigInt(cz)*BigInt(cz)*0x4307a7n +
            BigInt(cz)*0x5f24fen ^ 0x3ad8025fn;
  rnd = rnd & 0xffffffffn;
  let n = Number(rnd);
  if (n > 0x7fffffff) n -= 0x100000000;
  return (n % 10) === 0;
}

function drawMap(){
  const seed=parseInt(document.getElementById('seed').value);
  noiseGen = new openSimplexNoise.OpenSimplexNoise(seed);
  const px=parseInt(document.getElementById('playerX').value);
  const pz=parseInt(document.getElementById('playerZ').value);
  const range=parseInt(document.getElementById('range').value);
  const showTerrain=document.getElementById('showTerrain').checked;
  const heightShading=document.getElementById('heightShading').checked;
  const showSlime=document.getElementById('showSlime').checked;
  const showStructures=document.getElementById('showStructures').checked;
  const showCaves=document.getElementById('showCaves').checked;
  const showGrid=document.getElementById('showGrid').checked;

  const size=range*2;
  const img=ctx.createImageData(size,size);
  let i=0;
  for(let z=0;z<size;z++){
    for(let x=0;x<size;x++){
      const bx=px-range+x+offsetX, bz=pz-range+z+offsetZ;
      let rgb=[200,200,200];
      if(showTerrain){
        rgb=biomeColor(bx,bz);
        if(heightShading){
          const elev=noiseGen.noise2D(bx/100,bz/100);
          rgb=shadeColor(rgb,elev,true);
        }
      }
      if(showCaves && noiseGen.noise2D(bx/30,bz/30)>0.7) rgb=[100,100,100];
      if(showSlime && isSlimeChunk(seed,bx,bz)) rgb=[0,255,0,180]; // bright green
      img.data[i++]=rgb[0];
      img.data[i++]=rgb[1];
      img.data[i++]=rgb[2];
      img.data[i++]=255;
    }
  }
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const tmp=document.createElement('canvas');
  tmp.width=size; tmp.height=size;
  tmp.getContext('2d').putImageData(img,0,0);
  const drawSize=canvas.width*zoom;
  ctx.drawImage(tmp,0,0,size,size,(canvas.width-drawSize)/2,(canvas.height-drawSize)/2,drawSize,drawSize);

  // Player marker
  ctx.fillStyle="#ff0000";
  ctx.beginPath();
  ctx.arc(canvas.width/2,canvas.height/2,5,0,Math.PI*2);
  ctx.fill();
}

// Zoom
canvas.addEventListener("wheel", e=>{
  e.preventDefault();
  zoom*=e.deltaY<0?1.1:0.9;
  zoom=Math.max(0.25,Math.min(8,zoom));
  drawMap();
},{passive:false});

// Panning
canvas.addEventListener("mousedown", e=>{dragging=true;dragStartX=e.clientX;dragStartY=e.clientY;});
canvas.addEventListener("mouseup", ()=>dragging=false);
canvas.addEventListener("mousemove", e=>{
  if(dragging){
    offsetX -= Math.round((e.clientX-dragStartX)/zoom);
    offsetZ -= Math.round((e.clientY-dragStartY)/zoom);
    dragStartX=e.clientX; dragStartY=e.clientY;
    drawMap();
  }
});

function exportMap(){
  const link=document.createElement('a');
  link.download='map.png';
  link.href=canvas.toDataURL();
  link.click();
}

window.onload=drawMap;
</script>
</body>
</html>
